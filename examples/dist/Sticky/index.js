import{pageScrollBehaviors}from"../behaviors/page-scroll.js";const ROOT_ELEMENT=".lin-sticky";Component({options:{addGlobalClass:!0,multipleSlots:!0},behaviors:[pageScrollBehaviors((function(e){null==this.properties.scrollTop&&this.onScroll(e)}))],externalClasses:["custom-class","wrapper-class"],properties:{offsetTop:{type:Number,value:0,observer:"onScroll"},zIndex:{type:Number,value:99},disabled:{type:Boolean,observer:"onScroll"},container:{type:null,observer:"onScroll"},scrollTop:{type:null,observer(e){this.onScroll({scrollTop:e})}}},data:{fixed:!1,transform:0,height:0},methods:{onScroll({scrollTop:e}={}){const{container:t,offsetTop:o,disabled:s}=this.properties;s?this.setDataAfterDiff({fixed:!1,transform:0}):(this.scrollTop=e||this.scrollTop,"function"!=typeof t?this.getRect(ROOT_ELEMENT).then(e=>{o>e.top?this.setDataAfterDiff({fixed:!0,height:e.height}):this.setDataAfterDiff({fixed:!1})}):Promise.all([this.getRect(ROOT_ELEMENT),this.getContainerRect()]).then(([e,t])=>{o+e.height>t.height+t.top?this.setDataAfterDiff({fixed:!1,transform:t.height-e.height}):o>=e.top?this.setDataAfterDiff({fixed:!0,height:e.height,transform:0}):this.setDataAfterDiff({fixed:!1,transform:0})}))},setDataAfterDiff(e){wx.nextTick(()=>{const t=Object.keys(e).reduce((t,o)=>(e[o]!==this.properties[o]&&(t[o]=e[o]),t),{});this.setData(t),this.triggerEvent("scroll",{scrollTop:this.scrollTop,isFixed:e.fixed||this.data.fixed})})},getRect(e){return new Promise(t=>{const o=this.createSelectorQuery();o.select(e).boundingClientRect(),o.exec(e=>{t(e[0])})})},getContainerRect(){const e=this.properties.container();return new Promise(t=>{e.boundingClientRect(t).exec()})}},created:function(){},attached:function(){},ready:function(){},moved:function(){},detached:function(){}});