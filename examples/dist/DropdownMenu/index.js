import{getSystemInfoSync}from"../common/utils";import defaulrProps from"./props";let ARRAY=[];Component({options:{addGlobalClass:!0,multipleSlots:!0},relations:{"../DropdownItem/index":{type:"descendant",linked(e){this.children=this.children||[],this.children.push(e),this.updateItemListData()},unlinked(e){this.children=(this.children||[]).filter(t=>t!==e),this.updateItemListData()}}},externalClasses:["custom-class","wrapper-class","item-class"],properties:{activeColor:{type:String,value:defaulrProps.activeColor,observer:"updateChildrenData"},zIndex:{type:Number,value:10},duration:{type:Number,value:defaulrProps.duration,observer:"updateChildrenData"},direction:{type:String,value:defaulrProps.direction,options:["down","up"],observer:"updateChildrenData"},mask:{type:Boolean,value:defaulrProps.mask,observer:"updateChildrenData"},closeOnClickMask:{type:Boolean,value:defaulrProps.closeOnClickMask,observer:"updateChildrenData"},closeOnClickOutside:{type:Boolean,value:!0}},data:{itemListData:[]},methods:{onTitleTap(e){const t=e.currentTarget.dataset.index;this.children[t].properties.disabled||(ARRAY.forEach(e=>{e&&e.properties.closeOnClickOutside&&e!==this&&e.close()}),this.toggleItem(t))},close(){(this.children||[]).forEach(e=>{e.hide(!0)})},toggleItem(e){(this.children||[]).forEach((t,i)=>{const{showPopup:a}=t.data;i==e?t.toggle():a&&t.hide(!0)})},updateItemListData(){this.setData({itemListData:this.children.map(e=>e.data)})},updateChildrenData(){(this.children||[]).forEach(e=>{e.updateDataFromParent()})},getChildWrapperStyle(){const{zIndex:e,direction:t}=this.properties;return new Promise((i,a)=>{const o=this.createSelectorQuery();o.select(".lin-dropdown-menu-bar-wrapper").boundingClientRect(),o.exec(a=>{const{top:o=0,bottom:r=0}=a[0];let s=`z-index:${e};`;s+="down"===t?`top:${r}px;`:`bottom:${this.windowHeight-o}px`,i(s)})})}},created:function(){},attached:function(){},ready:function(){const{windowHeight:e}=getSystemInfoSync();this.windowHeight=e,ARRAY.push(this)},moved:function(){},detached:function(){ARRAY=ARRAY.filter(e=>e!==this)}});