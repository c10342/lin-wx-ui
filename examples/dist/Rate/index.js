import{RED}from"../common/color";Component({behaviors:["wx://form-field"],externalClasses:["custom-class","icon-class","void-icon-class"],options:{addGlobalClass:!0},properties:{gutter:{type:String,value:"4px"},color:{type:String,value:RED},voidColor:{type:String,value:"#c8c9cc"},allowHalf:Boolean,iconSize:{type:String,value:"50rpx"},value:{type:Number,observer:"setWidth"},count:{type:Number,value:5,observer:"setCount"},icon:{type:String,value:"star1"},voidIcon:{type:String,value:"star1-o"},readonly:Boolean,disabled:Boolean,disabledColor:{type:String,value:"#bdbdbd"}},data:{innerCountArray:Array.from({length:5}),width:"0"},methods:{setCount(){this.setData({innerCountArray:Array.from({length:this.properties.count})})},setWidth(){let{value:t,gutter:e}=this.properties;e=parseFloat(e);const{innerCountArray:r}=this.data;if(!this.rateWidth||!this.containerLeft)return;let i=0;t>r.length&&(t=r.length),t<0&&(t=0);const o=Math.floor(t);let n=Math.ceil(t-1)*e;n=n<0?0:n,i=o*this.rateWidth+n+(t-o)*this.rateWidth,this.setData({width:i+"px"})},onClick(t){let{gutter:e,allowHalf:r,readonly:i,disabled:o}=this.properties;if(i||o)return;e=parseFloat(e);let n=t.currentTarget.dataset.index;if(r){const e=t.currentTarget.offsetLeft;t.detail.x-this.containerLeft-e>this.rateWidth/2?n+=1:n+=.5}else n+=1;this.triggerEvent("change",n)}},created:function(){},attached:function(){},ready:function(){this.setCount();const t=this.createSelectorQuery();t.select("#lin-rate-0").boundingClientRect(),t.select("#lin-rate-o").boundingClientRect(),t.exec(t=>{this.rateWidth=t[0].width,this.containerLeft=t[1].left,this.setWidth()})},moved:function(){},detached:function(){}});